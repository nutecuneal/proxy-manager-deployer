version: '3.8'
services:
  nginx:
    image: 'nginx:1.23.3-alpine'
    container_name: nginx-app
    ports:
      - '80:80'
      - '443:443'
    volumes:
      - '/hostPath/nginx.conf:/etc/nginx/nginx.conf:ro'
      - '/hostPath/nginxLog:/var/log/nginx'
      - '/hostPath/letsEtc/live:/certs:ro'
      - '/hostPath/certbotAcmeChallenge:/data/www/acme-challenge:ro'
    networks:
      rproxy-net:
        ipv4_address: 172.18.0.2
    restart: always
    healthcheck:
      test: [ 'CMD', 'curl', '-fs', 'http://localhost' ]
      interval: 3m
      timeout: 30s
      retries: 3
      start_period: 30s
networks:
  rproxy-net:
    name: reverse-proxy-net
    ipam:
      driver: default
      config:
        - subnet: '172.18.0.0/28'
          gateway: 172.18.0.1
